"use strict";(self.webpackChunk_yozora_doc=self.webpackChunk_yozora_doc||[]).push([[4383],{7292:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return d},contentTitle:function(){return p},metadata:function(){return c},toc:function(){return m},default:function(){return u}});var n=a(7462),r=a(3366),o=(a(7294),a(4137)),i=a(7358),l=a(8448),s=["components"],d={id:"ast-util",title:"@yozora/ast-util",sidebar_label:"ast-util"},p=void 0,c={unversionedId:"package/ast-util",id:"package/ast-util",isDocsHomePage:!1,title:"@yozora/ast-util",description:"<img",source:"@site/docs/package/ast-util.mdx",sourceDirName:"package",slug:"/package/ast-util",permalink:"/docs/package/ast-util",version:"current",lastUpdatedAt:1629025401,formattedLastUpdatedAt:"8/15/2021",frontMatter:{id:"ast-util",title:"@yozora/ast-util",sidebar_label:"ast-util"},sidebar:"API",previous:{title:"ast",permalink:"/docs/package/ast"},next:{title:"core-tokenizer",permalink:"/docs/package/core-tokenizer"}},m=[{value:"Install",id:"install",children:[]},{value:"Usage",id:"usage",children:[{value:"Example",id:"example",children:[]}]},{value:"Related",id:"related",children:[]}],k={toc:m};function u(e){var t=e.components,a=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,n.Z)({},k,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("header",null,(0,o.kt)("div",{align:"center"},(0,o.kt)("a",{href:"https://www.npmjs.com/package/@yozora/ast-util"},(0,o.kt)("img",{alt:"Npm Version",src:"https://img.shields.io/npm/v/@yozora/ast-util.svg"})),(0,o.kt)("a",{href:"https://www.npmjs.com/package/@yozora/ast-util"},(0,o.kt)("img",{alt:"Npm Download",src:"https://img.shields.io/npm/dm/@yozora/ast-util.svg"})),(0,o.kt)("a",{href:"https://www.npmjs.com/package/@yozora/ast-util"},(0,o.kt)("img",{alt:"Npm License",src:"https://img.shields.io/npm/l/@yozora/ast-util.svg"})),(0,o.kt)("a",{href:"#install"},(0,o.kt)("img",{alt:"Module formats: cjs, esm",src:"https://img.shields.io/badge/module_formats-cjs%2C%20esm-green.svg"})),(0,o.kt)("a",{href:"https://github.com/nodejs/node"},(0,o.kt)("img",{alt:"Node.js Version",src:"https://img.shields.io/node/v/@yozora/ast-util"})),(0,o.kt)("a",{href:"https://github.com/prettier/prettier"},(0,o.kt)("img",{alt:"Code Style: prettier",src:"https://img.shields.io/badge/code_style-prettier-ff69b4.svg?style=flat-square"})))),(0,o.kt)("br",null),(0,o.kt)("p",null,"This package contains a collect of utility functions to handle ",(0,o.kt)("a",{parentName:"p",href:"/docs/package/ast-util"},"Yozora markdown ast"),"."),(0,o.kt)("h2",{id:"install"},"Install"),(0,o.kt)(i.Z,{defaultValue:"npm",groupId:"npm2yarn",values:[{label:"npm",value:"npm"},{label:"Yarn",value:"yarn"}],mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"npm",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install --save @yozora/ast-util\n"))),(0,o.kt)(l.Z,{value:"yarn",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add @yozora/ast-util\n")))),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"center"},"Name"),(0,o.kt)("th",{parentName:"tr",align:"center"},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"calcHeadingToc")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Generate heading toc, and update the referenced ",(0,o.kt)("inlineCode",{parentName:"td"},"Heading.identifier")," simultaneously")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"calcDefinitionMap")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Traverse yozora ast and generate a link reference definition map.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"calcFootnoteDefinitionMap")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Traverse yozora ast and generate a footnote reference definition map.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"collectDefinitions")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Collect link reference definitions in a pre-order traversal.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"collectFootnoteDefinitions")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Collect footnote reference definitions in a pre-order traversal.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"defaultUrlResolver")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Default url resolver")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"replaceAST")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Traverse Yozora AST and perform a replacing operation for each matched node (",(0,o.kt)("strong",{parentName:"td"},"irreversible"),")")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"replaceFootnotesInReferences")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Replace inline footnotes into footnote references and footnote reference definitions (",(0,o.kt)("strong",{parentName:"td"},"irreversible"),")")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"resolveUrlsForAst")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Traverse Yozora AST and resolve urls for aim nodes (",(0,o.kt)("strong",{parentName:"td"},"irreversible"),")")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"searchNode")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Search a node from Yozora AST in pre-order traversing")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"shallowCloneAst")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Shallow clone the Yozora AST until the match reaches the termination condition.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},(0,o.kt)("inlineCode",{parentName:"td"},"traverseAST")),(0,o.kt)("td",{parentName:"tr",align:"center"},"Traverse Yozora AST and perform a mutating operation for each matched node")))),(0,o.kt)("h3",{id:"example"},"Example"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { ImageType, BlockquoteType } from '@yozora/ast'\nimport { \n  collectDefinitions,\n  collectFootnoteDefinitions,\n  calcHeadingToc, \n  replaceAST, \n  traverseAST,\n} from '@yozora/ast-util'\n\n// Collect definitions.\ncollectDefinitions(\n  root,               // Yozora ast root\n  [DefinitionType],   // aim Yast types, optional\n  [],                 // preset definitions, optional\n)\n\n// Collect footnote definitions.\ncollectFootnoteDefinitions(\n  root,                     // Yozora ast root\n  [FootnoteDefinitionType], // aim Yast types, optional\n  [],                       // preset footnote definitions, optional\n  true,                     // prefer reference type footnotes, optional.\n)\n\n// traverse the Yozora AST and set the image title to the image alt\ntraverseAST(\n  root,                           // Yozora ast root\n  [ImageType],                    // aim Yast types, required\n  (node) => node.title = node.alt // mutating operation, required\n)\n\n// traverse the Yozora AST and replace the image to two images.\nreplaceAST(\n  root, \n  [ImageType], \n  (node) => [node, node]\n)\n\n// Generate heading toc, each toc node's identifier will with the prefix 'custom-identifier-prefix-'.\n// The default prefix is 'heading-'\ncalcHeadingToc(root, 'custom-identifier-prefix-')\n\n// shallow clone the Yozora AST until a blockquote type node with a blockquote \n// type parent and in addition it is not the first child of its parent encountered.\nconst root2 = shallowCloneAst(\n  root, \n  (node, parent, childIndex) => (\n    parent.type === BlockquoteType && \n    childIndex > 0 && \n    node.type === BlockquoteType\n  )\n)\n")),(0,o.kt)("h2",{id:"related"},"Related"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/package/ast-util"},"@yozora/ast")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/yozorajs/yozora/tree/main/packages/ast-util"},"Sourcecode"))))}u.isMDXComponent=!0}}]);